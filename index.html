<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Internal Initiatives Tracker</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', -apple-system, sans-serif; }
    #root { min-height: 100vh; }
  </style>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflar.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useMemo } = React;
    const {
      BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,
      LineChart, Line, PieChart, Pie, Cell, AreaChart, Area, Legend
    } = Recharts;

    // ── Data ──────────────────────────────────────────────────────────────
    const INITIATIVES = [
      { id: 1, name: "AI Agent Accelerator Toolkit", category: "AI & Automation", owner: "Platform Engineering", status: "In Progress", priority: "High", startDate: "2025-09", targetDate: "2026-03", completion: 72, hoursInvested: 840, hoursSaved: 3200, costSavings: 480000, revenueImpact: 1200000, satisfaction: 4.6, fte: 4 },
      { id: 2, name: "Digital Factory Playbook v2", category: "Methodology", owner: "Delivery Excellence", status: "In Progress", priority: "High", startDate: "2025-07", targetDate: "2026-01", completion: 88, hoursInvested: 620, hoursSaved: 1800, costSavings: 270000, revenueImpact: 850000, satisfaction: 4.8, fte: 3 },
      { id: 3, name: "Power Platform CoE Dashboard", category: "Governance", owner: "Platform Engineering", status: "Complete", priority: "Medium", startDate: "2025-04", targetDate: "2025-10", completion: 100, hoursInvested: 380, hoursSaved: 960, costSavings: 144000, revenueImpact: 320000, satisfaction: 4.3, fte: 2 },
      { id: 4, name: "Copilot Studio Starter Kit", category: "AI & Automation", owner: "Rapid Solutions", status: "In Progress", priority: "High", startDate: "2025-10", targetDate: "2026-04", completion: 45, hoursInvested: 520, hoursSaved: 2100, costSavings: 315000, revenueImpact: 980000, satisfaction: 4.5, fte: 3 },
      { id: 5, name: "Legacy Mod Assessment Tool", category: "Tools & IP", owner: "Rapid Solutions", status: "In Progress", priority: "Medium", startDate: "2025-08", targetDate: "2026-02", completion: 61, hoursInvested: 410, hoursSaved: 1400, costSavings: 210000, revenueImpact: 620000, satisfaction: 4.1, fte: 2 },
      { id: 6, name: "Client Onboarding Automation", category: "AI & Automation", owner: "Delivery Excellence", status: "Complete", priority: "High", startDate: "2025-03", targetDate: "2025-09", completion: 100, hoursInvested: 290, hoursSaved: 1600, costSavings: 240000, revenueImpact: 410000, satisfaction: 4.7, fte: 2 },
      { id: 7, name: "Estimation Model & Calculator", category: "Tools & IP", owner: "Delivery Excellence", status: "In Progress", priority: "Medium", startDate: "2025-11", targetDate: "2026-05", completion: 30, hoursInvested: 180, hoursSaved: 800, costSavings: 120000, revenueImpact: 290000, satisfaction: 4.0, fte: 1 },
      { id: 8, name: "Pod Capacity Planner", category: "Methodology", owner: "Platform Engineering", status: "Planning", priority: "Low", startDate: "2026-01", targetDate: "2026-06", completion: 12, hoursInvested: 60, hoursSaved: 500, costSavings: 75000, revenueImpact: 180000, satisfaction: 0, fte: 1 },
      { id: 9, name: "Reusable Component Library", category: "Tools & IP", owner: "Rapid Solutions", status: "In Progress", priority: "High", startDate: "2025-06", targetDate: "2026-01", completion: 78, hoursInvested: 720, hoursSaved: 2800, costSavings: 420000, revenueImpact: 750000, satisfaction: 4.4, fte: 3 },
      { id: 10, name: "Governance & ALM Automation", category: "Governance", owner: "Platform Engineering", status: "In Progress", priority: "Medium", startDate: "2025-09", targetDate: "2026-03", completion: 55, hoursInvested: 340, hoursSaved: 1100, costSavings: 165000, revenueImpact: 400000, satisfaction: 4.2, fte: 2 },
      { id: 11, name: "Skills Matrix & Training Hub", category: "Methodology", owner: "Delivery Excellence", status: "Planning", priority: "Low", startDate: "2026-01", targetDate: "2026-07", completion: 8, hoursInvested: 40, hoursSaved: 600, costSavings: 90000, revenueImpact: 200000, satisfaction: 0, fte: 1 },
      { id: 12, name: "Customer Success Insights Agent", category: "AI & Automation", owner: "Rapid Solutions", status: "In Progress", priority: "High", startDate: "2025-10", targetDate: "2026-06", completion: 38, hoursInvested: 460, hoursSaved: 1900, costSavings: 285000, revenueImpact: 870000, satisfaction: 4.3, fte: 3 },
    ];

    const MONTHLY_TREND = [
      { month: "Jul", hoursSaved: 420, costSavings: 63, initiatives: 5, roi: 2.1 },
      { month: "Aug", hoursSaved: 680, costSavings: 102, initiatives: 6, roi: 2.8 },
      { month: "Sep", hoursSaved: 1040, costSavings: 156, initiatives: 8, roi: 3.2 },
      { month: "Oct", hoursSaved: 1580, costSavings: 237, initiatives: 10, roi: 3.6 },
      { month: "Nov", hoursSaved: 2100, costSavings: 315, initiatives: 11, roi: 4.1 },
      { month: "Dec", hoursSaved: 2640, costSavings: 396, initiatives: 11, roi: 4.4 },
      { month: "Jan", hoursSaved: 3200, costSavings: 480, initiatives: 12, roi: 4.8 },
      { month: "Feb", hoursSaved: 3860, costSavings: 579, initiatives: 12, roi: 5.2 },
    ];

    const COLORS = {
      primary: "#1B59F8", secondary: "#F2C80F", success: "#17B169", warning: "#FF8C00",
      danger: "#E74856", purple: "#8B5CF6", teal: "#06B6D4", slate: "#64748B",
      bg: "#F3F2F1", cardBg: "#FFFFFF", text: "#252423", textMuted: "#605E5C",
      border: "#EDEBE9", headerBg: "#1B1A19",
    };

    const PIE_COLORS = [COLORS.primary, COLORS.secondary, COLORS.success, COLORS.purple, COLORS.teal];
    const fmt = (n) => n >= 1000000 ? `$${(n / 1000000).toFixed(1)}M` : n >= 1000 ? `$${(n / 1000).toFixed(0)}K` : `$${n}`;
    const fmtNum = (n) => n >= 1000 ? `${(n / 1000).toFixed(1)}K` : `${n}`;

    // ── Components ────────────────────────────────────────────────────────

    function KPICard({ label, value, subValue, icon, color, trend }) {
      return (
        <div style={{
          background: COLORS.cardBg, borderRadius: 4, padding: "18px 20px",
          borderTop: `3px solid ${color}`, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)",
          display: "flex", flexDirection: "column", gap: 4, minWidth: 0
        }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
            <span style={{ fontSize: 11, fontWeight: 600, color: COLORS.textMuted, textTransform: "uppercase", letterSpacing: "0.5px" }}>{label}</span>
            <span style={{ fontSize: 16 }}>{icon}</span>
          </div>
          <div style={{ fontSize: 28, fontWeight: 700, color: COLORS.text, lineHeight: 1.1, fontFamily: "'Segoe UI', sans-serif" }}>{value}</div>
          <div style={{ display: "flex", alignItems: "center", gap: 6 }}>
            {trend && <span style={{ fontSize: 11, fontWeight: 600, color: trend > 0 ? COLORS.success : COLORS.danger }}>{trend > 0 ? "\u25B2" : "\u25BC"} {Math.abs(trend)}%</span>}
            <span style={{ fontSize: 11, color: COLORS.textMuted }}>{subValue}</span>
          </div>
        </div>
      );
    }

    function FilterPill({ label, active, onClick }) {
      return (
        <button onClick={onClick} style={{
          padding: "5px 14px", borderRadius: 3, fontSize: 12, fontWeight: active ? 600 : 400, cursor: "pointer",
          background: active ? COLORS.primary : "transparent", color: active ? "#fff" : COLORS.textMuted,
          border: active ? "none" : `1px solid ${COLORS.border}`, transition: "all 0.15s"
        }}>{label}</button>
      );
    }

    function StatusBadge({ status }) {
      const map = { "Complete": COLORS.success, "In Progress": COLORS.primary, "Planning": COLORS.slate };
      return (
        <span style={{
          display: "inline-flex", alignItems: "center", gap: 5, fontSize: 11, fontWeight: 600,
          color: map[status] || COLORS.textMuted, background: `${map[status] || COLORS.slate}15`,
          padding: "3px 10px", borderRadius: 3
        }}>
          <span style={{ width: 6, height: 6, borderRadius: "50%", background: map[status] }}></span>
          {status}
        </span>
      );
    }

    function PriorityDot({ priority }) {
      const map = { "High": COLORS.danger, "Medium": COLORS.warning, "Low": COLORS.slate };
      return <span style={{ display: "inline-block", width: 8, height: 8, borderRadius: "50%", background: map[priority] }} title={priority}></span>;
    }

    function ProgressBar({ value, color }) {
      return (
        <div style={{ display: "flex", alignItems: "center", gap: 8, minWidth: 120 }}>
          <div style={{ flex: 1, height: 6, background: "#E8E6E3", borderRadius: 3, overflow: "hidden" }}>
            <div style={{ width: `${value}%`, height: "100%", background: color || COLORS.primary, borderRadius: 3, transition: "width 0.6s ease" }}></div>
          </div>
          <span style={{ fontSize: 11, fontWeight: 600, color: COLORS.textMuted, minWidth: 32 }}>{value}%</span>
        </div>
      );
    }

    function SectionTitle({ children, subtitle }) {
      return (
        <div style={{ marginBottom: 12 }}>
          <div style={{ fontSize: 14, fontWeight: 700, color: COLORS.text }}>{children}</div>
          {subtitle && <div style={{ fontSize: 11, color: COLORS.textMuted, marginTop: 2 }}>{subtitle}</div>}
        </div>
      );
    }

    const CustomTooltip = ({ active, payload, label, formatter }) => {
      if (!active || !payload?.length) return null;
      return (
        <div style={{
          background: "#fff", border: `1px solid ${COLORS.border}`, borderRadius: 4,
          padding: "10px 14px", boxShadow: "0 4px 12px rgba(0,0,0,0.12)", fontSize: 12
        }}>
          <div style={{ fontWeight: 600, marginBottom: 6, color: COLORS.text }}>{label}</div>
          {payload.map((p, i) => (
            <div key={i} style={{ display: "flex", alignItems: "center", gap: 6, marginBottom: 2 }}>
              <span style={{ width: 8, height: 8, borderRadius: 2, background: p.color }}></span>
              <span style={{ color: COLORS.textMuted }}>{p.name}:</span>
              <span style={{ fontWeight: 600, color: COLORS.text }}>{formatter ? formatter(p.value) : p.value}</span>
            </div>
          ))}
        </div>
      );
    };

    // ── Main Dashboard ────────────────────────────────────────────────────

    function InitiativeTracker() {
      const [categoryFilter, setCategoryFilter] = useState("All");
      const [statusFilter, setStatusFilter] = useState("All");
      const [ownerFilter, setOwnerFilter] = useState("All");
      const [selectedInit, setSelectedInit] = useState(null);
      const [activeTab, setActiveTab] = useState("overview");

      const categories = ["All", ...new Set(INITIATIVES.map(i => i.category))];
      const statuses = ["All", ...new Set(INITIATIVES.map(i => i.status))];
      const owners = ["All", ...new Set(INITIATIVES.map(i => i.owner))];

      const filtered = useMemo(() => INITIATIVES.filter(i =>
        (categoryFilter === "All" || i.category === categoryFilter) &&
        (statusFilter === "All" || i.status === statusFilter) &&
        (ownerFilter === "All" || i.owner === ownerFilter)
      ), [categoryFilter, statusFilter, ownerFilter]);

      const totals = useMemo(() => ({
        count: filtered.length,
        hoursInvested: filtered.reduce((a, b) => a + b.hoursInvested, 0),
        hoursSaved: filtered.reduce((a, b) => a + b.hoursSaved, 0),
        costSavings: filtered.reduce((a, b) => a + b.costSavings, 0),
        revenueImpact: filtered.reduce((a, b) => a + b.revenueImpact, 0),
        avgCompletion: Math.round(filtered.reduce((a, b) => a + b.completion, 0) / (filtered.length || 1)),
        fte: filtered.reduce((a, b) => a + b.fte, 0),
        complete: filtered.filter(i => i.status === "Complete").length,
        inProgress: filtered.filter(i => i.status === "In Progress").length,
        planning: filtered.filter(i => i.status === "Planning").length,
      }), [filtered]);

      const roi = totals.hoursInvested > 0 ? ((totals.costSavings + totals.revenueImpact) / (totals.hoursInvested * 150)).toFixed(1) : 0;

      const categoryBreakdown = useMemo(() => {
        const map = {};
        filtered.forEach(i => {
          if (!map[i.category]) map[i.category] = { name: i.category, value: 0, savings: 0, revenue: 0, count: 0 };
          map[i.category].value += i.costSavings;
          map[i.category].savings += i.costSavings;
          map[i.category].revenue += i.revenueImpact;
          map[i.category].count++;
        });
        return Object.values(map);
      }, [filtered]);

      const ownerBreakdown = useMemo(() => {
        const map = {};
        filtered.forEach(i => {
          if (!map[i.owner]) map[i.owner] = { name: i.owner, costSavings: 0, revenueImpact: 0, hoursInvested: 0, hoursSaved: 0 };
          map[i.owner].costSavings += i.costSavings;
          map[i.owner].revenueImpact += i.revenueImpact;
          map[i.owner].hoursInvested += i.hoursInvested;
          map[i.owner].hoursSaved += i.hoursSaved;
        });
        return Object.values(map);
      }, [filtered]);

      const statusData = [
        { name: "Complete", value: totals.complete, color: COLORS.success },
        { name: "In Progress", value: totals.inProgress, color: COLORS.primary },
        { name: "Planning", value: totals.planning, color: COLORS.slate },
      ].filter(d => d.value > 0);

      return (
        <div style={{ minHeight: "100vh", background: COLORS.bg, fontFamily: "'Segoe UI', -apple-system, sans-serif" }}>
          {/* Header Bar */}
          <div style={{
            background: COLORS.headerBg, color: "#fff", padding: "0 24px",
            display: "flex", alignItems: "center", height: 48, gap: 16
          }}>
            <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
              <svg width="20" height="20" viewBox="0 0 20 20"><rect x="1" y="8" width="5" height="11" rx="1" fill="#F2C80F"/><rect x="7.5" y="4" width="5" height="15" rx="1" fill="#F2C80F"/><rect x="14" y="1" width="5" height="18" rx="1" fill="#F2C80F"/></svg>
              <span style={{ fontWeight: 700, fontSize: 15, letterSpacing: "-0.2px" }}>Internal Initiatives Tracker</span>
            </div>
            <div style={{ flex: 1 }}></div>
            <div style={{ display: "flex", gap: 6 }}>
              {["overview", "details", "impact"].map(tab => (
                <button key={tab} onClick={() => setActiveTab(tab)} style={{
                  padding: "6px 16px", borderRadius: 3, fontSize: 12, fontWeight: 600, cursor: "pointer",
                  background: activeTab === tab ? "rgba(255,255,255,0.15)" : "transparent",
                  color: activeTab === tab ? "#fff" : "rgba(255,255,255,0.6)",
                  border: "none", textTransform: "capitalize", transition: "all 0.15s"
                }}>{tab}</button>
              ))}
            </div>
            <div style={{ fontSize: 11, color: "rgba(255,255,255,0.5)" }}>Last refreshed: Feb 4, 2026</div>
          </div>

          {/* Subtitle bar */}
          <div style={{
            background: "#fff", padding: "10px 24px", borderBottom: `1px solid ${COLORS.border}`,
            display: "flex", alignItems: "center", gap: 8, flexWrap: "wrap"
          }}>
            <span style={{ fontSize: 11, fontWeight: 600, color: COLORS.textMuted, marginRight: 4 }}>FILTERS</span>
            <div style={{ display: "flex", gap: 4, flexWrap: "wrap" }}>
              {categories.map(c => <FilterPill key={c} label={c} active={categoryFilter === c} onClick={() => setCategoryFilter(c)} />)}
            </div>
            <div style={{ width: 1, height: 20, background: COLORS.border, margin: "0 8px" }}></div>
            <div style={{ display: "flex", gap: 4, flexWrap: "wrap" }}>
              {statuses.map(s => <FilterPill key={s} label={s} active={statusFilter === s} onClick={() => setStatusFilter(s)} />)}
            </div>
            <div style={{ width: 1, height: 20, background: COLORS.border, margin: "0 8px" }}></div>
            <div style={{ display: "flex", gap: 4, flexWrap: "wrap" }}>
              {owners.map(o => <FilterPill key={o} label={o} active={ownerFilter === o} onClick={() => setOwnerFilter(o)} />)}
            </div>
          </div>

          {/* Content */}
          <div style={{ padding: 20, maxWidth: 1400, margin: "0 auto" }}>

            {/* KPI Row */}
            <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(180px, 1fr))", gap: 12, marginBottom: 20 }}>
              <KPICard label="Active Initiatives" value={totals.count} subValue={`${totals.complete} complete`} icon="\uD83D\uDCCB" color={COLORS.primary} trend={18} />
              <KPICard label="Total Cost Savings" value={fmt(totals.costSavings)} subValue="projected annual" icon="\uD83D\uDCB0" color={COLORS.success} trend={24} />
              <KPICard label="Revenue Impact" value={fmt(totals.revenueImpact)} subValue="pipeline influenced" icon="\uD83D\uDCC8" color={COLORS.secondary} trend={31} />
              <KPICard label="Hours Saved" value={fmtNum(totals.hoursSaved)} subValue={`${fmtNum(totals.hoursInvested)} invested`} icon="\u23F1\uFE0F" color={COLORS.purple} trend={22} />
              <KPICard label="ROI Multiple" value={`${roi}x`} subValue="return on investment" icon="\uD83C\uDFAF" color={COLORS.teal} trend={15} />
              <KPICard label="Avg Completion" value={`${totals.avgCompletion}%`} subValue={`${totals.fte} FTEs allocated`} icon="\uD83D\uDE80" color={COLORS.warning} />
            </div>

            {activeTab === "overview" && (
              <React.Fragment>
                {/* Charts Row 1 */}
                <div style={{ display: "grid", gridTemplateColumns: "2fr 1fr", gap: 12, marginBottom: 12 }}>
                  {/* Trend Chart */}
                  <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)" }}>
                    <SectionTitle subtitle="Jul 2025 \u2013 Feb 2026">Cumulative Impact Over Time</SectionTitle>
                    <ResponsiveContainer width="100%" height={240}>
                      <AreaChart data={MONTHLY_TREND}>
                        <defs>
                          <linearGradient id="gradSavings" x1="0" y1="0" x2="0" y2="1">
                            <stop offset="0%" stopColor={COLORS.success} stopOpacity={0.3} />
                            <stop offset="100%" stopColor={COLORS.success} stopOpacity={0.02} />
                          </linearGradient>
                          <linearGradient id="gradHours" x1="0" y1="0" x2="0" y2="1">
                            <stop offset="0%" stopColor={COLORS.primary} stopOpacity={0.2} />
                            <stop offset="100%" stopColor={COLORS.primary} stopOpacity={0.02} />
                          </linearGradient>
                        </defs>
                        <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" />
                        <XAxis dataKey="month" tick={{ fontSize: 11, fill: COLORS.textMuted }} />
                        <YAxis yAxisId="left" tick={{ fontSize: 11, fill: COLORS.textMuted }} tickFormatter={v => `$${v}K`} />
                        <YAxis yAxisId="right" orientation="right" tick={{ fontSize: 11, fill: COLORS.textMuted }} tickFormatter={v => `${v}`} />
                        <Tooltip content={<CustomTooltip />} />
                        <Legend wrapperStyle={{ fontSize: 11 }} />
                        <Area yAxisId="left" type="monotone" dataKey="costSavings" name="Cost Savings ($K)" stroke={COLORS.success} fill="url(#gradSavings)" strokeWidth={2.5} dot={{ r: 3, fill: COLORS.success }} />
                        <Area yAxisId="right" type="monotone" dataKey="hoursSaved" name="Hours Saved" stroke={COLORS.primary} fill="url(#gradHours)" strokeWidth={2.5} dot={{ r: 3, fill: COLORS.primary }} />
                      </AreaChart>
                    </ResponsiveContainer>
                  </div>

                  {/* Status + Category */}
                  <div style={{ display: "flex", flexDirection: "column", gap: 12 }}>
                    <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)", flex: 1 }}>
                      <SectionTitle>Status Breakdown</SectionTitle>
                      <div style={{ display: "flex", alignItems: "center" }}>
                        <ResponsiveContainer width="50%" height={130}>
                          <PieChart>
                            <Pie data={statusData} cx="50%" cy="50%" innerRadius={32} outerRadius={55} paddingAngle={3} dataKey="value">
                              {statusData.map((entry, i) => <Cell key={i} fill={entry.color} />)}
                            </Pie>
                          </PieChart>
                        </ResponsiveContainer>
                        <div style={{ display: "flex", flexDirection: "column", gap: 8 }}>
                          {statusData.map((d, i) => (
                            <div key={i} style={{ display: "flex", alignItems: "center", gap: 8 }}>
                              <span style={{ width: 10, height: 10, borderRadius: 2, background: d.color }}></span>
                              <span style={{ fontSize: 12, color: COLORS.textMuted }}>{d.name}</span>
                              <span style={{ fontSize: 13, fontWeight: 700, color: COLORS.text }}>{d.value}</span>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                    <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)", flex: 1 }}>
                      <SectionTitle>Category Investment</SectionTitle>
                      <ResponsiveContainer width="100%" height={130}>
                        <PieChart>
                          <Pie data={categoryBreakdown} cx="50%" cy="50%" outerRadius={55} dataKey="value" label={({ name, percent }) => `${name.split(" ")[0]} ${(percent * 100).toFixed(0)}%`}>
                            {categoryBreakdown.map((_, i) => <Cell key={i} fill={PIE_COLORS[i % PIE_COLORS.length]} />)}
                          </Pie>
                          <Tooltip formatter={v => fmt(v)} />
                        </PieChart>
                      </ResponsiveContainer>
                    </div>
                  </div>
                </div>

                {/* Charts Row 2 */}
                <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12, marginBottom: 12 }}>
                  <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)" }}>
                    <SectionTitle subtitle="Cost savings and revenue impact by team">Impact by Team</SectionTitle>
                    <ResponsiveContainer width="100%" height={220}>
                      <BarChart data={ownerBreakdown} layout="vertical" barGap={2}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" horizontal={false} />
                        <XAxis type="number" tick={{ fontSize: 10, fill: COLORS.textMuted }} tickFormatter={v => `$${(v/1000).toFixed(0)}K`} />
                        <YAxis dataKey="name" type="category" width={120} tick={{ fontSize: 11, fill: COLORS.text }} />
                        <Tooltip formatter={v => fmt(v)} />
                        <Legend wrapperStyle={{ fontSize: 11 }} />
                        <Bar dataKey="costSavings" name="Cost Savings" fill={COLORS.success} radius={[0, 3, 3, 0]} barSize={14} />
                        <Bar dataKey="revenueImpact" name="Revenue Impact" fill={COLORS.primary} radius={[0, 3, 3, 0]} barSize={14} />
                      </BarChart>
                    </ResponsiveContainer>
                  </div>

                  <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)" }}>
                    <SectionTitle subtitle="Monthly ROI multiple growth">ROI Trajectory</SectionTitle>
                    <ResponsiveContainer width="100%" height={220}>
                      <LineChart data={MONTHLY_TREND}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" />
                        <XAxis dataKey="month" tick={{ fontSize: 11, fill: COLORS.textMuted }} />
                        <YAxis tick={{ fontSize: 11, fill: COLORS.textMuted }} tickFormatter={v => `${v}x`} domain={[0, 'auto']} />
                        <Tooltip content={<CustomTooltip formatter={v => `${v}x`} />} />
                        <Line type="monotone" dataKey="roi" name="ROI" stroke={COLORS.secondary} strokeWidth={3} dot={{ r: 5, fill: COLORS.secondary, stroke: "#fff", strokeWidth: 2 }} activeDot={{ r: 7 }} />
                      </LineChart>
                    </ResponsiveContainer>
                  </div>
                </div>
              </React.Fragment>
            )}

            {activeTab === "details" && (
              <div style={{ background: COLORS.cardBg, borderRadius: 4, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)", overflow: "hidden" }}>
                <div style={{ padding: "16px 20px", borderBottom: `1px solid ${COLORS.border}` }}>
                  <SectionTitle subtitle={`${filtered.length} initiatives \u2022 Sorted by priority and completion`}>Initiative Details</SectionTitle>
                </div>
                <div style={{ overflowX: "auto" }}>
                  <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
                    <thead>
                      <tr style={{ background: "#FAFAF9" }}>
                        {["", "Initiative", "Category", "Owner", "Status", "Progress", "Hours Saved", "Cost Savings", "Revenue Impact", "Satisfaction"].map(h => (
                          <th key={h} style={{
                            padding: "10px 14px", textAlign: "left", fontWeight: 600, fontSize: 11,
                            color: COLORS.textMuted, borderBottom: `1px solid ${COLORS.border}`,
                            textTransform: "uppercase", letterSpacing: "0.3px", whiteSpace: "nowrap"
                          }}>{h}</th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {filtered.sort((a, b) => b.completion - a.completion).map((init, idx) => (
                        <tr key={init.id}
                          onClick={() => setSelectedInit(selectedInit === init.id ? null : init.id)}
                          style={{
                            cursor: "pointer", transition: "background 0.1s",
                            background: selectedInit === init.id ? "#F0F4FF" : idx % 2 === 0 ? "#fff" : "#FAFAF9",
                          }}
                          onMouseEnter={e => e.currentTarget.style.background = "#F0F4FF"}
                          onMouseLeave={e => e.currentTarget.style.background = selectedInit === init.id ? "#F0F4FF" : idx % 2 === 0 ? "#fff" : "#FAFAF9"}
                        >
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}` }}><PriorityDot priority={init.priority} /></td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}`, fontWeight: 600, color: COLORS.text, maxWidth: 220 }}>{init.name}</td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}`, color: COLORS.textMuted }}>{init.category}</td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}`, color: COLORS.textMuted, whiteSpace: "nowrap" }}>{init.owner}</td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}` }}><StatusBadge status={init.status} /></td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}` }}><ProgressBar value={init.completion} color={init.completion === 100 ? COLORS.success : COLORS.primary} /></td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}`, fontWeight: 600, color: COLORS.text }}>{fmtNum(init.hoursSaved)}</td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}`, fontWeight: 600, color: COLORS.success }}>{fmt(init.costSavings)}</td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}`, fontWeight: 600, color: COLORS.primary }}>{fmt(init.revenueImpact)}</td>
                          <td style={{ padding: "10px 14px", borderBottom: `1px solid ${COLORS.border}` }}>
                            {init.satisfaction > 0 ? (
                              <div style={{ display: "flex", alignItems: "center", gap: 4 }}>
                                <span style={{ color: COLORS.secondary }}>{"\u2605"}</span>
                                <span style={{ fontWeight: 600 }}>{init.satisfaction}</span>
                              </div>
                            ) : <span style={{ color: COLORS.textMuted }}>{"\u2014"}</span>}
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

            {activeTab === "impact" && (
              <React.Fragment>
                {/* Executive Summary */}
                <div style={{
                  background: "linear-gradient(135deg, #1B1A19 0%, #2D2B2A 100%)", borderRadius: 4,
                  padding: 28, marginBottom: 12, color: "#fff", boxShadow: "0 4px 16px rgba(0,0,0,0.15)"
                }}>
                  <div style={{ fontSize: 20, fontWeight: 700, marginBottom: 6 }}>Executive Impact Summary</div>
                  <div style={{ fontSize: 13, color: "rgba(255,255,255,0.7)", lineHeight: 1.6, maxWidth: 800 }}>
                    Our internal initiatives portfolio of <strong style={{ color: COLORS.secondary }}>{totals.count} active programs</strong> has
                    delivered <strong style={{ color: COLORS.success }}>{fmt(totals.costSavings)}</strong> in cost savings and
                    influenced <strong style={{ color: "#60A5FA" }}>{fmt(totals.revenueImpact)}</strong> in pipeline revenue.
                    With <strong style={{ color: "#fff" }}>{fmtNum(totals.hoursSaved)} hours saved</strong> against {fmtNum(totals.hoursInvested)} hours invested,
                    we're achieving a <strong style={{ color: COLORS.secondary }}>{roi}x return</strong> on internal innovation investment.
                  </div>
                </div>

                <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12, marginBottom: 12 }}>
                  <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)" }}>
                    <SectionTitle subtitle="Hours invested vs. hours saved per initiative">Investment vs. Return</SectionTitle>
                    <ResponsiveContainer width="100%" height={280}>
                      <BarChart data={filtered.sort((a, b) => (b.hoursSaved - b.hoursInvested) - (a.hoursSaved - a.hoursInvested))}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" />
                        <XAxis dataKey="name" tick={{ fontSize: 9, fill: COLORS.textMuted }} angle={-35} textAnchor="end" height={80} interval={0} />
                        <YAxis tick={{ fontSize: 10, fill: COLORS.textMuted }} />
                        <Tooltip />
                        <Legend wrapperStyle={{ fontSize: 11 }} />
                        <Bar dataKey="hoursInvested" name="Hours Invested" fill={COLORS.danger} radius={[3, 3, 0, 0]} barSize={18} opacity={0.7} />
                        <Bar dataKey="hoursSaved" name="Hours Saved" fill={COLORS.success} radius={[3, 3, 0, 0]} barSize={18} />
                      </BarChart>
                    </ResponsiveContainer>
                  </div>

                  <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)" }}>
                    <SectionTitle subtitle="Total financial impact by initiative category">Financial Impact by Category</SectionTitle>
                    <ResponsiveContainer width="100%" height={280}>
                      <BarChart data={categoryBreakdown}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" />
                        <XAxis dataKey="name" tick={{ fontSize: 10, fill: COLORS.textMuted }} />
                        <YAxis tick={{ fontSize: 10, fill: COLORS.textMuted }} tickFormatter={v => `$${(v/1000).toFixed(0)}K`} />
                        <Tooltip formatter={v => fmt(v)} />
                        <Legend wrapperStyle={{ fontSize: 11 }} />
                        <Bar dataKey="savings" name="Cost Savings" fill={COLORS.success} radius={[3, 3, 0, 0]} barSize={28} />
                        <Bar dataKey="revenue" name="Revenue Impact" fill={COLORS.primary} radius={[3, 3, 0, 0]} barSize={28} />
                      </BarChart>
                    </ResponsiveContainer>
                  </div>
                </div>

                {/* Value Stories */}
                <div style={{ background: COLORS.cardBg, borderRadius: 4, padding: 20, boxShadow: "0 1.6px 3.6px rgba(0,0,0,0.08)" }}>
                  <SectionTitle subtitle="Highlighting the top performing initiatives by total impact">Top Value Drivers</SectionTitle>
                  <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(280px, 1fr))", gap: 12 }}>
                    {filtered.sort((a, b) => (b.costSavings + b.revenueImpact) - (a.costSavings + a.revenueImpact)).slice(0, 4).map((init, i) => (
                      <div key={init.id} style={{
                        border: `1px solid ${COLORS.border}`, borderRadius: 4, padding: 16,
                        borderLeft: `4px solid ${PIE_COLORS[i % PIE_COLORS.length]}`
                      }}>
                        <div style={{ fontSize: 13, fontWeight: 700, color: COLORS.text, marginBottom: 4 }}>{init.name}</div>
                        <div style={{ fontSize: 11, color: COLORS.textMuted, marginBottom: 12 }}>{init.category} {"\u2022"} {init.owner}</div>
                        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8 }}>
                          <div>
                            <div style={{ fontSize: 10, color: COLORS.textMuted, textTransform: "uppercase" }}>Savings</div>
                            <div style={{ fontSize: 18, fontWeight: 700, color: COLORS.success }}>{fmt(init.costSavings)}</div>
                          </div>
                          <div>
                            <div style={{ fontSize: 10, color: COLORS.textMuted, textTransform: "uppercase" }}>Revenue</div>
                            <div style={{ fontSize: 18, fontWeight: 700, color: COLORS.primary }}>{fmt(init.revenueImpact)}</div>
                          </div>
                        </div>
                        <div style={{ marginTop: 10 }}>
                          <ProgressBar value={init.completion} color={PIE_COLORS[i % PIE_COLORS.length]} />
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </React.Fragment>
            )}

            {/* Footer */}
            <div style={{
              marginTop: 16, padding: "12px 0", borderTop: `1px solid ${COLORS.border}`,
              display: "flex", justifyContent: "space-between", fontSize: 10, color: COLORS.textMuted
            }}>
              <span>Internal Initiatives Tracker {"\u2022"} Power Platform & AI Practice</span>
              <span>Data simulated for demonstration {"\u2022"} {filtered.length} of {INITIATIVES.length} initiatives shown</span>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<InitiativeTracker />);
  </script>
</body>
</html>
